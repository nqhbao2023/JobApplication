// Database Schema for JobApplication Project
// Based on Firestore NoSQL Structure (11 Collections)

Table users {
  uid varchar [pk, note: "Firebase Auth UID"]
  email varchar
  displayName varchar
  photoURL varchar
  role varchar [note: "'candidate', 'employer', 'admin'"]
  phoneNumber varchar
  studentProfile json [note: "Nested object for candidate info"]
  companyProfile json [note: "Nested object for employer info"]
  createdAt timestamp
  updatedAt timestamp
}

Table jobs {
  id varchar [pk, note: "Auto-generated ID"]
  title varchar
  description text [note: "HTML content"]
  salary json [note: "{min, max, currency, type}"]
  jobType varchar [note: "'employer_seeking' or 'candidate_seeking'"]
  source varchar [note: "'internal', 'viecoi', 'quick-post'"]
  status varchar [note: "'pending', 'active', 'rejected', 'closed'"]
  posterId varchar [note: "Ref to users.uid"]
  companyId varchar [note: "Ref to companies.id (optional)"]
  categoryId varchar [note: "Ref to job_categories.id"]
  location varchar
  skills json [note: "Array of strings"]
  requirements json [note: "Array of strings"]
  benefits json [note: "Array of strings"]
  viewCount integer
  applicantCount integer
  createdAt timestamp
}

Table applications {
  id varchar [pk]
  jobId varchar
  candidateId varchar
  employerId varchar
  cvUrl varchar
  coverLetter text
  status varchar [note: "'pending', 'accepted', 'rejected'"]
  appliedAt timestamp
  reviewedAt timestamp
}

Table companies {
  id varchar [pk]
  name varchar [note: "corp_name"]
  logo varchar [note: "image"]
  description text [note: "corp_description"]
  address varchar [note: "city/nation"]
  website varchar
  ownerId varchar [note: "Ref to users.uid"]
  isVerified boolean
}

Table job_categories {
  id varchar [pk]
  name varchar [note: "category_name"]
  icon varchar [note: "icon_name"]
  color varchar
  description varchar
  active boolean
}

Table job_types {
  id varchar [pk]
  type_name varchar
}

Table saved_jobs {
  id varchar [pk]
  userId varchar
  jobId varchar
  savedAt timestamp
}

Table applied_jobs {
  id varchar [pk]
  userId varchar
  jobId varchar
  appliedAt timestamp
}

Table cvs {
  id varchar [pk]
  userId varchar
  type varchar [note: "'template' or 'uploaded'"]
  pdfUrl varchar
  fileUrl varchar
  fileName varchar
  personalInfo json
  education json
  skills json
  experience json
  projects json
  activities json
  certifications json
  languages json
  references json
  templateId varchar
  isDefault boolean
  createdAt timestamp
  updatedAt timestamp
}

Table chats {
  id varchar [pk]
  senderId varchar
  receiverId varchar
  text text
  jobId varchar
  createdAt timestamp
}

Table notifications {
  id varchar [pk]
  userId varchar
  title varchar
  message text
  read boolean
  type varchar
  createdAt timestamp
}

// Relationships (Logical References for NoSQL)

Ref: jobs.posterId > users.uid
Ref: jobs.companyId > companies.id
Ref: jobs.categoryId > job_categories.id

Ref: applications.jobId > jobs.id
Ref: applications.candidateId > users.uid
Ref: applications.employerId > users.uid

Ref: companies.ownerId - users.uid // One-to-One (usually)

Ref: saved_jobs.userId > users.uid
Ref: saved_jobs.jobId > jobs.id

Ref: applied_jobs.userId > users.uid
Ref: applied_jobs.jobId > jobs.id

Ref: cvs.userId > users.uid

Ref: chats.senderId > users.uid
Ref: chats.receiverId > users.uid
Ref: chats.jobId > jobs.id

Ref: notifications.userId > users.uid
