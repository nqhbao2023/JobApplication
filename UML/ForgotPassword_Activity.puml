@startuml ForgotPassword_Activity
' Cấu hình giao diện bảng (Table look)
skinparam SwimlaneBorderColor black
skinparam SwimlaneTitleBackgroundColor white
skinparam SwimlaneTitleFontColor black
skinparam ActivityBackgroundColor white
skinparam ActivityBorderColor black
skinparam ArrowColor black
skinparam Shadowing false
skinparam pageBorderColor black
skinparam pageMargin 10

title Sơ đồ Hoạt động Quên Mật Khẩu

|Người dùng|
start
:Mở màn hình Quên mật khẩu;
:Nhập Email;
:Nhấn "Gửi mã xác nhận";

|Ứng dụng Mobile|
:Gửi yêu cầu gửi OTP;

|Backend API|
:Kiểm tra Email có tồn tại không;
if (Email tồn tại?) then (Có)
  :Tạo mã OTP 6 số;
  :Gửi OTP qua Email;
else (Không)
  :Trả về thông báo giả (bảo mật);
endif

|Người dùng|
:Nhận Email chứa mã OTP;
:Nhập mã OTP vào ứng dụng;

|Ứng dụng Mobile|
:Gửi yêu cầu xác thực OTP;

|Backend API|
:Xác thực mã OTP;
if (OTP đúng?) then (Đúng)
  :Trả về kết quả thành công;
else (Sai)
  :Trả về lỗi OTP không hợp lệ;
  stop
endif

|Ứng dụng Mobile|
:Chuyển đến màn hình Đặt lại mật khẩu;

|Người dùng|
:Nhập Mật khẩu mới & Xác nhận;
:Nhấn "Đặt lại mật khẩu";

|Ứng dụng Mobile|
:Gửi yêu cầu đổi mật khẩu;

|Backend API|
:Cập nhật mật khẩu mới trong Firebase;
:Hủy hiệu lực mã OTP;
:Trả về kết quả thành công;

|Ứng dụng Mobile|
:Hiển thị thông báo thành công;
:Điều hướng về màn hình Đăng nhập;

|Người dùng|
:Đăng nhập với mật khẩu mới;
stop

@enduml
